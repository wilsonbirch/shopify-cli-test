import { urlNamespaces } from '../../../constants.js';
import { setupGraphiQLServer } from '../graphiql/server.js';
import { isSpinEnvironment, spinFqdn } from '@shopify/cli-kit/node/context/spin';
export async function setupGraphiQLServerProcess(options) {
    const shopCustomDomain = isSpinEnvironment() ? `shopify.${await spinFqdn()}` : undefined;
    return {
        type: 'graphiql',
        prefix: `graphiql`,
        urlPrefix: `/${urlNamespaces.devTools}/graphiql`,
        options: { ...options, port: -1, shopCustomDomain },
        function: launchGraphiQLServer,
    };
}
export const launchGraphiQLServer = async ({ stdout, stderr, abortSignal }, options) => {
    const httpServer = setupGraphiQLServer({ ...options, stdout });
    abortSignal.addEventListener('abort', async () => {
        await httpServer.close();
    });
};
//# sourceMappingURL=graphiql.js.map