{"version":3,"file":"graphiql.js","sourceRoot":"","sources":["../../../../../src/cli/services/dev/processes/graphiql.ts"],"names":[],"mappings":"AACA,OAAO,EAAC,aAAa,EAAC,MAAM,uBAAuB,CAAA;AACnD,OAAO,EAAC,mBAAmB,EAAC,MAAM,uBAAuB,CAAA;AACzD,OAAO,EAAC,iBAAiB,EAAE,QAAQ,EAAC,MAAM,oCAAoC,CAAA;AAmB9E,MAAM,CAAC,KAAK,UAAU,0BAA0B,CAC9C,OAAwE;IAExE,MAAM,gBAAgB,GAAG,iBAAiB,EAAE,CAAC,CAAC,CAAC,WAAW,MAAM,QAAQ,EAAE,EAAE,CAAC,CAAC,CAAC,SAAS,CAAA;IAExF,OAAO;QACL,IAAI,EAAE,UAAU;QAChB,MAAM,EAAE,UAAU;QAClB,SAAS,EAAE,IAAI,aAAa,CAAC,QAAQ,WAAW;QAChD,OAAO,EAAE,EAAC,GAAG,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC,EAAE,gBAAgB,EAAC;QACjD,QAAQ,EAAE,oBAAoB;KAC/B,CAAA;AACH,CAAC;AAED,MAAM,CAAC,MAAM,oBAAoB,GAAqD,KAAK,EACzF,EAAC,MAAM,EAAE,MAAM,EAAE,WAAW,EAAC,EAC7B,OAAqC,EACrC,EAAE;IACF,MAAM,UAAU,GAAG,mBAAmB,CAAC,EAAC,GAAG,OAAO,EAAE,MAAM,EAAC,CAAC,CAAA;IAC5D,WAAW,CAAC,gBAAgB,CAAC,OAAO,EAAE,KAAK,IAAI,EAAE;QAC/C,MAAM,UAAU,CAAC,KAAK,EAAE,CAAA;IAC1B,CAAC,CAAC,CAAA;AACJ,CAAC,CAAA","sourcesContent":["import {BaseProcess, DevProcessFunction} from './types.js'\nimport {urlNamespaces} from '../../../constants.js'\nimport {setupGraphiQLServer} from '../graphiql/server.js'\nimport {isSpinEnvironment, spinFqdn} from '@shopify/cli-kit/node/context/spin'\n\ninterface GraphiQLServerProcessOptions {\n  appName: string\n  appUrl: string\n  apiKey: string\n  apiSecret: string\n  storeFqdn: string\n  url: string\n  port: number\n  scopes: string[]\n  shopCustomDomain: string | undefined\n}\n\nexport interface GraphiQLServerProcess extends BaseProcess<GraphiQLServerProcessOptions> {\n  type: 'graphiql'\n  urlPrefix: string\n}\n\nexport async function setupGraphiQLServerProcess(\n  options: Omit<GraphiQLServerProcessOptions, 'port' | 'shopCustomDomain'>,\n): Promise<GraphiQLServerProcess> {\n  const shopCustomDomain = isSpinEnvironment() ? `shopify.${await spinFqdn()}` : undefined\n\n  return {\n    type: 'graphiql',\n    prefix: `graphiql`,\n    urlPrefix: `/${urlNamespaces.devTools}/graphiql`,\n    options: {...options, port: -1, shopCustomDomain},\n    function: launchGraphiQLServer,\n  }\n}\n\nexport const launchGraphiQLServer: DevProcessFunction<GraphiQLServerProcessOptions> = async (\n  {stdout, stderr, abortSignal},\n  options: GraphiQLServerProcessOptions,\n) => {\n  const httpServer = setupGraphiQLServer({...options, stdout})\n  abortSignal.addEventListener('abort', async () => {\n    await httpServer.close()\n  })\n}\n"]}